#!/usr/bin/env python3

import urllib
import http.client as httplib
import time
import datetime

id = '12345678901234'
server = 'iotstagingenv.duckdns.org:5055'

# server = 'localhost:5055'



points = [
   ("2025-11-21 03:12:21",43.6585166,-79.72349,100,217),
   ("2025-11-21 03:12:21",43.653447,-79.729953,100,217),
   ("2025-11-21 03:12:22",43.6584883,-79.7235766,100,217),
   ("2025-11-21 03:12:24",43.65838,-79.7237633,100,217),
   ("2025-11-21 03:12:24",43.65838,-79.7237633,100,217),
   ("2025-11-21 03:12:24",43.65838,-79.7237633,100,217),
   ("2025-11-21 03:12:20",43.65853,-79.7234,100,217),
   ("2025-11-21 03:12:21",43.6585166,-79.72349,100,217),
   ("2025-11-21 03:12:22",43.6584883,-79.7235766,100,217),
   ("2025-11-21 03:12:24",43.65838,-79.7237633,100,217),
   ("2025-11-21 03:12:24",43.65838,-79.7237633,100,217),
   ("2025-11-21 03:12:24",43.65838,-79.7237633,100,217),
   ("2025-11-21 03:12:25",43.6582749,-79.7238633,100,217),
   ("2025-11-21 03:12:27",43.6580383,-79.7241283,100,217),
   ("2025-11-21 03:12:34",43.6573349,-79.7249416,100,217),
   ("2025-11-21 03:12:42",43.6565533,-79.7258283,100,217),
   ("2025-11-21 03:12:50",43.6557366,-79.7266833,100,217),
   ("2025-11-21 03:12:58",43.655,-79.7275433,100,217),
   ("2025-11-21 03:13:06",43.6542466,-79.728315,100,217),
   ("2025-11-21 03:13:09",43.6539616,-79.7286766,100,217),
   ("2025-11-21 03:13:12",43.6537383,-79.7290283,100,217),
   ("2025-11-21 03:13:18",43.6534466,-79.7299533,100,217),
   ("2025-11-21 03:13:24",43.6532983,-79.730985,100,217),
   ("2025-11-21 03:13:32",43.6532083,-79.7322566,100,217),
   ("2025-11-21 03:13:06",43.6542466,-79.728315,100,217),
   ("2025-11-21 03:13:09",43.6539616,-79.7286766,100,217),
   ("2025-11-21 03:13:12",43.6537383,-79.7290283,100,217),
   ("2025-11-21 03:13:18",43.6534466,-79.7299533,100,217),
   ("2025-11-21 03:13:24",43.6532983,-79.730985,100,217),
   ("2025-11-21 03:13:32",43.6532083,-79.7322566,100,217),
   ("2025-11-21 03:13:36",43.6531749,-79.7326716,100,217),
   ("2025-11-21 03:13:37",43.6531483,-79.7327283,100,217),
   ("2025-11-21 03:13:37",43.6531483,-79.7327283,100,217),
   ("2025-11-21 03:13:38",43.6531183,-79.7327549,100,217),
   ("2025-11-21 03:13:39",43.6530616,-79.7327466,100,217),
   ("2025-11-21 03:13:40",43.6529783,-79.732715,100,217),
   ("2025-11-21 03:13:46",43.6525133,-79.7325733,100,217),
   ("2025-11-21 03:13:49",43.6523716,-79.7325666,100,217),
   ("2025-11-21 03:13:50",43.652345,-79.7325483,100,217),
   ("2025-11-21 03:13:51",43.652345,-79.732505,100,217),
   ("2025-11-21 03:13:52",43.6523949,-79.7324733,7.5594,10),
   ("2025-11-21 03:13:53",43.6524466,-79.7324666,100,217),
   ("2025-11-21 03:14:03",43.6530699,-79.7325216,11.3391,18),
   ("2025-11-21 03:14:04",43.65311,-79.7324833,10.7991,41),
   ("2025-11-21 03:14:04",43.65311,-79.7324833,10.7991,41),
   ("2025-11-21 03:14:04",43.65311,-79.7324833,10.7991,41),
   ("2025-11-21 03:14:05",43.6531416,-79.7324233,11.3391,58),
   ("2025-11-21 03:14:06",43.6531633,-79.7323416,11.8791,70),
   ("2025-11-21 03:14:08",43.6531833,-79.7321183,14.5788,83),
   ("2025-11-21 03:14:13",43.653225,-79.731425,20.5184,83),
   ("2025-11-21 03:14:21",43.6533566,-79.7301849,23.2182,80),
   ("2025-11-21 03:14:25",43.6534783,-79.729605,24.2981,67),
   ("2025-11-21 03:14:31",43.65383,-79.7287066,25.9179,57),
   ("2025-11-21 03:14:34",43.6540766,-79.7283316,24.838,41),
   ("2025-11-21 03:14:39",43.6544499,-79.7279166,19.4385,38),
   ("2025-11-21 03:14:42",43.6545466,-79.727825,11.8791,29),
   ("2025-11-21 03:14:48",43.6547733,-79.7276049,13.4989,37),
   ("2025-11-21 03:14:48",43.6547733,-79.7276049,13.4989,37),
   ("2025-11-21 03:14:55",43.6553,-79.7271283,15.6588,23),
   ("2025-11-21 03:14:56",43.6553366,-79.72712,14.0389,15),
   ("2025-11-21 03:14:56",43.6553366,-79.72712,14.0389,15),
   ("2025-11-21 03:14:58",43.6553333,-79.727205,100,217),
   ("2025-11-21 03:14:59",43.655245,-79.7272633,100,217),
   ("2025-11-21 03:14:59",43.655245,-79.7272633,100,217),
   ("2025-11-21 03:14:59",43.655245,-79.7272633,100,217),
   ("2025-11-21 03:15:01",43.6551016,-79.727395,100,217),
   ("2025-11-21 03:15:04",43.6548233,-79.7276866,100,217),
   ("2025-11-21 03:15:12",43.6540766,-79.7285216,100,217),
   ("2025-11-21 03:15:15",43.6538483,-79.72892,100,217),
   ("2025-11-21 03:15:20",43.6535183,-79.7296433,100,217),
   ("2025-11-21 03:15:23",43.6534183,-79.7301266,100,217),
   ("2025-11-21 03:15:31",43.6533133,-79.7314383,100,217),
   ("2025-11-21 03:15:36",43.6532483,-79.7320616,100,217),
   ("2025-11-21 03:15:39",43.6532333,-79.7322833,100,217),
   ("2025-11-21 03:15:42",43.653225,-79.7323483,100,217),
   ("2025-11-21 03:15:45",43.653225,-79.73235,100,217),
   ("2025-11-21 03:15:54",43.6532133,-79.732625,100,217),
   ("2025-11-21 03:15:56",43.65319,-79.7329183,100,217),
   ("2025-11-21 03:15:59",43.6531583,-79.733405,100,217),
   ("2025-11-21 03:16:03",43.6529866,-79.7340283,100,217),
   ("2025-11-21 03:16:06",43.6527716,-79.7345216,100,217),
   ("2025-11-21 03:16:09",43.6524366,-79.734945,100,217),
   ("2025-11-21 03:16:16",43.651725,-79.7357266,100,217),
   ("2025-11-21 03:16:20",43.6513666,-79.7360583,100,217),
   ("2025-11-21 03:16:23",43.6512516,-79.7361833,100,217),
   ("2025-11-21 03:16:25",43.6512316,-79.7362083,100,217),
   ("2025-11-21 03:16:28",43.651225,-79.7362166,100,217),
   ("2025-11-21 03:16:37",43.651225,-79.7362166,0,216),
   ("2025-11-21 03:16:55",43.6511783,-79.7362999,100,217),
   ("2025-11-21 03:17:06",43.651165,-79.736315,100,217),


]

def send(conn, time, lat, lon, speed, heading):
    params = (('id', id), ('timestamp', int(time)), ('lat', lat), ('lon', lon), ('speed', speed), ('heading', heading))
    conn.request('POST', '?' + urllib.parse.urlencode(params))
    conn.getresponse().read()

conn = httplib.HTTPConnection(server)

for i in range(0, len(points)):
    (moment,lat, lon, speed,heading) = points[i]
    (momentOld,latOld, lonOld, speedOld,headingOld) = points[i-1]

    time_dif = time.mktime(datetime.datetime.strptime(moment, "%Y-%m-%d %H:%M:%S").timetuple()) - time.mktime(datetime.datetime.strptime(momentOld, "%Y-%m-%d %H:%M:%S").timetuple())
    time.sleep(2)
#     if i-1 >= 0:
#         time.sleep(2)

    #send(conn, time.mktime(datetime.datetime.strptime(moment, "%Y-%m-%d %H:%M:%S").timetuple()), lat, lon, speed)
    print("sending ", time.mktime(time.localtime(time.time())), lat, lon, speed)
    send(conn, time.mktime(time.localtime(time.time())), lat, lon, speed,heading)

